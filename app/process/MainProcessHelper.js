//用于创建原生浏览器窗口的组件对象
const electron = require("electron");
const {app, shell, BrowserWindow, dialog, powerSaveBlocker, Tray, Menu} = electron; //引入electron
const path = require("path"); //原生库path模块

const {v4: uuidv4} = require('uuid');// 引入uuid工具类
const md5 = require('md5');// 引入md5工具类
const logger = require("../common/Logger"); //引入全局日志组件
const config = require("../common/Config"); //引入全局配置组件
const sessionCookie = require("../common/SessionCookie"); //引入全局sessionCookie组件
const urlHelper = require("../common/UrlHelper");
const activeWinHelper = require("../ext/win-info"); //活动窗口组件

// 为了保证一个对全局windows对象的引用，就必须在方法体外声明变量
// 否则当方法执行完成时就会被JavaScript的垃圾回收机制清理
let mainWindow = null;
let tray = null;
// 主窗口uuid和level
const mainWindowUUID = "mainWindow";
const mainWindowLevel = 1;
// 会议窗口uuid
const meetWindowUUID = "meetWindow";
// 投屏工具栏窗口uuid
const screenToolsWindowUUID = "screenTools";
// 选择投屏窗口uuid
const choseScreenWindowUUID = "choseScreen";
// 视屏窗口uuid
const openVideoBoxWindowUUID = "openVideoBox";

// 消息发送相关
// 主-InjectRtcAudioVideoScreenUtil.js
let meetToolsFormMainChannel = "meetToolsFormMain";
// 主-box.html
let meetToolsMessageFormMainChannel = "meetToolsMessageFormMain";
// 主-choseScreen.html
let meetChosesMessageFormMainChannel = "meetChosesMessageFormMain";
// 主-videoBox.html
let meetVideoMessageFormMainChannel = "meetVideoMessageFormMain";

// 防止休眠设置
let blockerId = null;

/* ↓全局变量配置区开始↓ */

//全局路由参数传递缓冲区
global.sharedObject = {
    args: {
        default: "default_arg",
    },
};

//全局窗口记录
let windowMap = new Map();
global.sharedWindow = {
    windowMap: windowMap, //全局窗口对象
};

// 全局用户信息
global.userInfo = {
    UID: null,
    vc: null,
    vc3: null,
    _d: null,
};

/* ↑全局变量配置区结束↑ */

function createMainWindow() {
    // 清空所有菜单
    //Menu.setApplicationMenu(Menu.buildFromTemplate([]));
    //Menu.setApplicationMenu(null);

    logger.info("[SessionCookie][init]初始化cookie");
    sessionCookie.init();

    logger.info("[MainProcessHelper][createMainWindow]初始化渲染窗口");

    // 生成窗口唯一uuid值
    let windowUUID = mainWindowUUID;
    // 生成窗口层级主窗口默认为1
    let windowLevel = mainWindowLevel;
    // 创建浏览器窗口
    let mainWindowConfig = config.getConfigVal("main_window");
    //更新标题和图标
    mainWindowConfig.title = config.getConfigVal("title");
    mainWindowConfig.icon = path.join(
        path.resolve(__dirname, ".."),
        config.getConfigVal("icon")
    );
    // 放入窗口唯一值
    mainWindowConfig.customUUID = windowUUID;
    mainWindowConfig.customLevel = windowLevel;
    mainWindow = new BrowserWindow(mainWindowConfig);

    /*// 开始加载
    mainWindow.webContents.on("did-start-loading", (e) => {
        console.log("did-start-loading");
        if (!e.sender.getURL().startsWith("file")) {
            let imgTemp = "data:image/gif;base64,R0lGODlhyADIAIABABZ3/////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZTI2ZDAyNy1lYTA3LTQ0NjctODY5NS1jOTA0MGUxMjQzOWEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RjY5RjhGRjk4MkYzMTFFQkJCMzdFQjFBNzcwMUI4RjAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RjY5RjhGRjg4MkYzMTFFQkJCMzdFQjFBNzcwMUI4RjAiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Yjc4MmY4MC1mZThmLTQxMzMtOWJmYS1iMTRlZGJjOTg4NWUiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozZWU5ODUyZS1kNGNiLWU3NGYtYTM2MC1mMWZjNDM5ZmQxMjQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4g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";
            let htmlTemp = '<div style="position: absolute;top: 40%;left: 0;-webkit-transform: translateY(-50%);width: 100%;text-align: center;"><img src="' + imgTemp + '" style="width:72px;"><p style="font-size:14px;color:#8A8B99;margin-top:7px;">连接中…</p></div>';
            let runJsTemp = 'let didStartLoadingDivTemp = document.createElement("div");didStartLoadingDivTemp.setAttribute("id", "didStartLoadingDivTemp");document.body.appendChild(didStartLoadingDivTemp);didStartLoadingDivTemp.innerHTML=\'' + htmlTemp + '\';';
            mainWindow.webContents.executeJavaScript(runJsTemp);
        }
    });
    // 结束加载
    mainWindow.webContents.on("did-finish-load", (e) => {
        console.log("did-finish-load");
        if (!e.sender.getURL().startsWith("file")) {
            let runJsTemp = 'document.getElementById("didStartLoadingDivTemp").style.display="none";';
            mainWindow.webContents.executeJavaScript(runJsTemp);
        }
    });*/
    // 结束加载
    mainWindow.webContents.on("did-stop-loading", (e) => {
        console.log("did-stop-loading", e.sender.getURL());
        if (e.sender.getURL().startsWith("file:")) {
            mainWindow.webContents.loadURL(config.getUrlPathConfigVal("main_url"));
        }
    });
    // 加载失败
    mainWindow.webContents.on("did-fail-load", (e,errorCode,errorDescription,validatedURL,isMainFrame,frameProcessId,frameRoutingId) => {
        console.log(`did-fail-load ${errorCode},${errorDescription},${validatedURL},${isMainFrame},${frameProcessId},${frameRoutingId}`);
        let imgTemp = "data:image/png;base64,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";
        let htmlTemp = '<div style="position: absolute;top: 40%;left: 0;-webkit-transform: translateY(-50%);width: 100%;text-align: center;"><div><span style="display: inline-block;background:url('+imgTemp+') left center no-repeat;background-size: 18px auto;padding-left:24px;font-size:14px;color:#8A8B99;line-height: 20px;">连接失败('+errorCode+')<span></div><input value="请重试" onclick="javascript:location.reload();" style="width: 92px;height:36px;line-height:36px;margin-top:14px;background:#1677FF;border-radius: 4px;text-align: center;font-size:14px;color:#FFF;border:0;cursor: pointer;"></div>';
        let runJsTemp = 'document.body.style.background="#F5F6F8";let didFailLoadingDivTemp = document.createElement("div");didFailLoadingDivTemp.setAttribute("id", "didFailLoadingDivTemp");document.body.appendChild(didFailLoadingDivTemp);didFailLoadingDivTemp.innerHTML=\''+htmlTemp+'\';';
        mainWindow.webContents.executeJavaScript(runJsTemp);
    });
    // 先加载加载动画
    mainWindow.loadFile(path.join(path.resolve(__dirname, ".."), "/view/loding.html"));
    // 引入主入口界面
    //mainWindow.loadURL(config.getUrlPathConfigVal("main_url"));

    if (config.getConfigVal("debug")) {
        // 打开开发者工具
        mainWindow.webContents.openDevTools();
    }

    // 删除菜单
    mainWindow.removeMenu();

    // 防止休眠设置
    blockerId = powerSaveBlocker.start("prevent-display-sleep");

    // 放入窗口集合中
    global.sharedWindow.windowMap.set(windowUUID, mainWindow);

    // 窗口监控
    all_win_event(mainWindow);

    // 当窗口关闭时触发
    mainWindow.on("closed", function () {
        logger.info("[MainProcessHelper][_mainWindow_.on._closed_]渲染窗口关闭");
        // 关闭休眠
        powerSaveBlocker.stop(blockerId);
        //将全局mainWindow置为null
        global.sharedWindow.windowMap.delete(windowUUID);
        mainWindow = null;
    });

    /*// 窗口关闭回调
    mainWindow.on("close", (event) => {
        if (process.platform !== "darwin") {
            mainWindow.hide();
            mainWindow.setSkipTaskbar(true);
            event.preventDefault();
        } else {
            // mac销毁托盘
            if (tray != null) {
                tray.destroy();
                tray = null;
            }
        }
        /!*mainWindow.hide();
        mainWindow.setSkipTaskbar(true);
        event.preventDefault();*!/
    });

    //创建系统通知区菜单
    tray = new Tray(
        path.join(path.resolve(__dirname, ".."), config.getConfigVal("trayIcon"))
    );

    // 托盘按钮
    const contextMenu = Menu.buildFromTemplate([
        {
            label: "显示",
            click: () => {
                if (global.sharedWindow.windowMap.size > 1) {
                    // 循环判断窗口
                    global.sharedWindow.windowMap.forEach(function (value, key) {
                        if (key !== mainWindowUUID) {
                            value.flashFrame(true);
                            //value.show();
                            return;
                        }
                    });
                } else {
                    // 显示任务栏
                    mainWindow.setSkipTaskbar(false);
                    // 闪烁提醒
                    //mainWindow.flashFrame(true);
                    // 显示聚焦
                    mainWindow.show();
                    // 显示不聚焦
                    //mainWindow.showInactive();
                }
            },
        },
        {
            label: "退出",
            click: () => {
                if (process.platform !== "darwin") {
                    mainWindow.destroy();
                    mainWindow = null;
                    app.quit();
                } else {
                    // 循环关闭窗口
                    global.sharedWindow.windowMap.forEach(function (value, key) {
                        if (key !== mainWindowUUID) {
                            value.destroy();
                            console.log("[MainProcessHelper][closeWindow]视图 " + key + " 已关闭");
                        }
                    });
                    // 销毁托盘
                    if (tray != null) {
                        tray.destroy();
                        tray = null;
                    }
                    // 销毁主窗口
                    mainWindow.destroy();
                    mainWindow = null;
                }
            },
        },
    ]);
    tray.setToolTip("超星课堂");
    tray.setContextMenu(contextMenu);
    tray.on("click", () => {
        if (!sessionCookie.isLogin()) {
            return;
        }
        if (global.sharedWindow.windowMap.size > 1) {
            // 循环判断窗口
            global.sharedWindow.windowMap.forEach(function (value, key) {
                if (key !== mainWindowUUID) {
                    value.flashFrame(true);
                    //value.show();
                    return;
                }
            });
        } else {
            // 显示任务栏
            mainWindow.setSkipTaskbar(false);
            // 闪烁提醒
            //mainWindow.flashFrame(true);
            // 显示聚焦
            mainWindow.show();
            // 显示不聚焦
            //mainWindow.showInactive();
        }
    });*/
}

/**
 * 返回全局mainWindow对象
 */
function getMainWindow() {
    return mainWindow;
}

/* ↓路由功能开始↓ */

/**
 * 打开新窗口并传递参数
 * @kind MainProcessOnly [仅能主进程调用]
 * @param {string} view 视图名称
 * @param {any} args 传递给新的视图的参数对象
 */
function openNewWindow(view, args) {
    // 未登录
    if (!sessionCookie.isLogin()) {
        return;
    }
    // 打开窗口逻辑
    if (args != null) {
        global.sharedObject.args.default = args; //保存路由传递参数到缓冲区
    }
    let viewWindow = global.sharedWindow.windowMap.get(view);
    if (!viewWindow) {
        let isWeb = false;
        let defaultArgs = global.sharedObject.args.default;
        // 创建浏览器窗口
        let viewWindowConfig = config.getConfigVal("default_window");
        if (defaultArgs != null) {
            // 是否是网页
            if (defaultArgs.isWeb) {
                isWeb = true;
                viewWindowConfig = config.getConfigVal("web_window");
            }
            // 处理参数中的宽高
            let viewWindowArgs = defaultArgs.window;
            if (viewWindowArgs) {
                let viewWindowWidth = viewWindowArgs.width;
                if (viewWindowWidth) {
                    viewWindowConfig.width = viewWindowWidth;
                }
                let viewWindowHeight = viewWindowArgs.height;
                if (viewWindowHeight) {
                    viewWindowConfig.height = viewWindowHeight;
                }
            }
        }
        //更新标题和图标
        viewWindowConfig.title = config.getConfigVal("title");
        //更新标题和图标
        viewWindowConfig.title = config.getConfigVal("title");
        viewWindowConfig.icon = path.join(
            path.resolve(__dirname, ".."),
            config.getConfigVal("icon")
        );
        // 放入窗口唯一值
        viewWindowConfig.uuid = uuidv4();
        viewWindow = new BrowserWindow(viewWindowConfig);
        logger.info("[MainProcessHelper][openNewWindow]新视图 " + view + " 已加载");
        if (isWeb) {
            viewWindow.loadURL(view);
            win_event(viewWindow);
        } else {
            const modalPath = path.join(
                path.resolve(__dirname, ".."),
                "/view/" + view + ".html"
            );
            /*  const modalPath = path.join(
              "file://",
              path.resolve(__dirname, ".."),
              "/view/" + view + ".html"
            ); */
            viewWindow.loadFile(modalPath);
        }
        if (config.getConfigVal("debug")) {
            // 打开开发者工具
            viewWindow.webContents.openDevTools();
        }

        // 窗口关闭的监听
        viewWindow.on("closed", (event) => {
            global.sharedWindow.windowMap.delete(view);
            viewWindow = null;
        });
        // 放入全局窗口中
        global.sharedWindow.windowMap.set(view, viewWindow);
    } else {
        viewWindow.show();
    }
}

// 监控窗口浏览器事件
function all_win_event(win) {
    // 拦截window.open事件
    win.webContents.on("new-window", function (event, url, frameName, disposition, options, additionalFeatures, referrer, postBody) {
        // 事件拦截
        if (url.startsWith("cxkt://openUrlOnBrowser?url=")) {
            // 用默认浏览器打开地址
            let openBrowserUrl = url.replace("cxkt://openUrlOnBrowser?url=", "");
            //shell.openExternal(decodeURIComponent(openBrowserUrl));
            shell.openExternal(openBrowserUrl);
            event.preventDefault();
            return;
        }
        // 当前窗口值
        let nowWindowUUID = event.sender.browserWindowOptions.customUUID;
        let nowWindowLevel = event.sender.browserWindowOptions.customLevel;
        // 生成窗口唯一uuid值
        let windowUUID = md5(url);
        if (url.startsWith(config.getUrlPathConfigVal("open_meet_url"))) {
            // 如果是会议
            windowUUID = meetWindowUUID;
        }
        let windowLevel = nowWindowLevel + 1;
        // 获取窗口集合中
        let childWindow = global.sharedWindow.windowMap.get(windowUUID);
        if (!childWindow) {
            // 默认配置项
            let webWindowConfig = config.getConfigVal("web_window");

            // 链接中width
            let viewWindowWidth = getUrlParamValue(url, "windowWidth");
            if (viewWindowWidth) {
                webWindowConfig.width = parseInt(viewWindowWidth);
            }
            // 链接中height
            let viewWindowHeight = getUrlParamValue(url, "windowHeight");
            if (viewWindowHeight) {
                webWindowConfig.height = parseInt(viewWindowHeight);
            }

            // 链接中minWidth
            let viewWindowMinWidth = getUrlParamValue(url, "minWindowWidth");
            if (viewWindowMinWidth) {
                webWindowConfig.minWidth = parseInt(viewWindowMinWidth);
            }
            // 链接中minHeight
            let viewWindowMinHeight = getUrlParamValue(url, "minWindowHeight");
            if (viewWindowMinHeight) {
                webWindowConfig.minHeight = parseInt(viewWindowMinHeight);
            }

            // 链接中是否可拖拽
            let viewWindowDrag = getUrlParamValue(url, "canDragWindowSize");
            if (viewWindowDrag) {
                if (viewWindowDrag === "true") {
                    webWindowConfig.resizable = true;
                    webWindowConfig.maximizable = true;
                    webWindowConfig.fullscreenable = true;
                } else {
                    webWindowConfig.resizable = false;
                    webWindowConfig.maximizable = false;
                    webWindowConfig.fullscreenable = false;
                }
            } else {
                // 链接中resizable固定大小（弃用）
                let viewWindowFixedSize = getUrlParamValue(url, "fixedWindowSize");
                if (viewWindowFixedSize) {
                    if (viewWindowFixedSize === "true") {
                        webWindowConfig.resizable = false;
                        webWindowConfig.maximizable = false;
                        webWindowConfig.fullscreenable = false;
                    } else {
                        webWindowConfig.resizable = true;
                        webWindowConfig.maximizable = true;
                        webWindowConfig.fullscreenable = true;
                    }
                }
            }

            // 链接中canMaximizeWindow是否可最大化
            let viewWindowMaximizable = getUrlParamValue(url, "canMaximizeWindow");
            if (viewWindowMaximizable) {
                if (viewWindowMaximizable === "true") {
                    webWindowConfig.maximizable = true;
                    webWindowConfig.fullscreenable = true;
                } else {
                    webWindowConfig.maximizable = false;
                    webWindowConfig.fullscreenable = false;
                }
            }
            //更新标题和图标
            webWindowConfig.title = config.getConfigVal("title");
            // 图标
            webWindowConfig.icon = path.join(
                path.resolve(__dirname, ".."),
                config.getConfigVal("icon")
            );

            // 设置主窗口和模态窗口
            // webWindowConfig.parent = mainWindow;
            // webWindowConfig.modal = true;

            // 会议链接判断
            let isMeeting = false;
            let isPreloadJs = false;
            let isTestDemo = false;
            if (url.startsWith(config.getUrlPathConfigVal("open_meet_url"))) {
                // 如果是会议
                isMeeting = true;
                isPreloadJs = true;
                //isTestDemo = true;
            }

            // 注入js脚本
            if (isPreloadJs) {
                // 开启nodejs
                webWindowConfig.webPreferences.nodeIntegration = true;
                webWindowConfig.webPreferences.enableRemoteModule = true;
                // 开启无框窗口
                webWindowConfig.frame = false;
                //webWindowConfig.titleBarStyle = "hidden";
                // 关闭请求跨域限制
                //webWindowConfig.webPreferences.webSecurity = false;
                // 如果是测试关闭注入
                if (!isTestDemo) {
                    // 注入脚本
                    webWindowConfig.webPreferences.preload = path.join(path.resolve(__dirname, ".."), "/controller/preload.js");
                }
            }
            // 放入窗口唯一uuid值
            webWindowConfig.customUUID = windowUUID;
            webWindowConfig.customLevel = windowLevel;
            webWindowConfig.customParentUUID = nowWindowUUID;
            webWindowConfig.customParentLevel = nowWindowLevel;
            // 是否需要刷新父页面
            if (url.startsWith(config.getUrlPathConfigVal("meet_setting_url"))) {
                webWindowConfig.customParentRefresh = true;
            }
            // 创建窗口
            childWindow = new BrowserWindow(webWindowConfig);

            if (config.getConfigVal("debug")) {
                // 打开开发者工具
                childWindow.webContents.openDevTools();
            }

            // 关闭菜单
            childWindow.removeMenu();

            // 如果是打开会议链接
            if (isMeeting) {
                if (config.getConfigVal("meet_debug")) {
                    childWindow.webContents.openDevTools();
                }
            }
            // 如果是打开会议链接
            if (isTestDemo) {
                let meetuuid = urlHelper.getQueryStringByUrl(url, "uuid");
                // 通过js来获取对象上token
                let runJsCodeTemp = "document.querySelector(\".meeting_record_item[data_uuid='" + meetuuid + "']\").getAttribute(\"data_tokens\")";
                mainWindow.webContents.executeJavaScript(runJsCodeTemp).then((meetTokens) => {
                    runJsCodeTemp = "document.querySelector(\".meeting_record_item[data_uuid='" + meetuuid + "']\").getAttribute(\"data_qrcode\")";
                    mainWindow.webContents.executeJavaScript(runJsCodeTemp).then((meetQrcode) => {
                        let urlAllParamValues = urlHelper.getUrlAllParamValues(url);
                        if (urlAllParamValues) {
                            urlAllParamValues = "?" + urlAllParamValues + "&tokens=";
                        } else {
                            urlAllParamValues = "?tokens=";
                        }
                        urlAllParamValues = urlAllParamValues + meetTokens + "&meetQrcode=" + meetQrcode;
                        childWindow.loadFile(path.join(path.resolve(__dirname, ".."), "/view/meeting.html"), {"search": urlAllParamValues});
                    });
                });
            } else {
                childWindow.loadURL(url);
            }
            logger.info("[MainProcessHelper][new-window]新视图 " + url + " 已加载");
            // 放入窗口集合中
            global.sharedWindow.windowMap.set(windowUUID, childWindow);
            //绑定事件
            all_win_event(childWindow);
            // 如果父窗口是一级
            if (mainWindow != null) {
                //隐藏父窗口
                mainWindow.hide();
            }
            // 当子窗口关闭前触发
            childWindow.on("close", function (e) {
                // 是否可关闭
                let isColseTemp = true;
                // 显示当前窗口
                e.sender.show();
                // 先判断是否存在对象
                let isHasBeforeWindowClose = false;
                let isHasBeforeunload = false;
                e.sender.webContents.executeJavaScript("typeof beforeWindowClose").then((result) => {
                    if (result === "function") {
                        isHasBeforeWindowClose = true;
                        // 存在执行此方法获取返回值
                        return e.sender.webContents.executeJavaScript("beforeWindowClose()");
                    }
                }).then((result) => {
                    if (isHasBeforeWindowClose) {
                        if (result === "1") {
                            isColseTemp = false;
                        } else {
                            isColseTemp = true;
                        }
                    } else {
                        // 判断是否有其它事件
                        return e.sender.webContents.executeJavaScript("typeof onbeforeunload");
                    }
                }).then((result) => {
                    if (result === "function") {
                        isHasBeforeunload = true;
                        // 判断是否有其它事件
                        return e.sender.webContents.executeJavaScript("onbeforeunload()");
                    }
                }).then((result) => {
                    if (isHasBeforeunload) {
                        if (result !== "undefined") {
                            isColseTemp = false;
                            // 关闭对话框
                            return dialog.showMessageBox(e.sender, {
                                type: 'none',
                                buttons: ['Cancel', 'Ok'],
                                title: " ",
                                detail: result,
                                noLink: true
                            });
                        }
                    }
                }).then((result) => {
                    if (isHasBeforeunload) {
                        if (result === 1) {
                            isColseTemp = true;
                        }
                    }
                }).then(() => {
                    if (isColseTemp) {
                        // 销毁
                        e.sender.destroy();
                    }
                })
                e.preventDefault();
            });
            // 当子窗口关闭时触发
            childWindow.on("closed", function () {
                logger.info("[MainProcessHelper][_childWindow_.on._closed_]渲染窗口关闭url=" + url);
                if (mainWindow != null) {
                    if (webWindowConfig.customParentRefresh) {
                        // 刷新主窗口页面
                        mainWindow.webContents.reloadIgnoringCache();
                    }
                    if (global.sharedWindow.windowMap.size == 2) {
                        //显示父窗口
                        mainWindow.show();
                    }
                }
                // 删除窗口集合中
                global.sharedWindow.windowMap.delete(windowUUID);
            });
        } else {
            childWindow.show();
        }
        event.preventDefault();
    });
    // 拦截跳转
    win.webContents.on("will-navigate", function (event, url) {
        // 事件拦截
        if (url.startsWith("cxkt://openUrlOnBrowser?url=")) {
            // 用默认浏览器打开地址
            let openBrowserUrl = url.replace("cxkt://openUrlOnBrowser?url=", "");
            //shell.openExternal(decodeURIComponent(openBrowserUrl));
            shell.openExternal(openBrowserUrl);
            event.preventDefault();
            return;
        }
        // 当前窗口值
        let nowWindowUUID = event.sender.browserWindowOptions.customUUID;
        let nowWindow = global.sharedWindow.windowMap.get(nowWindowUUID);
        // 默认配置项
        let web_window = config.getConfigVal("web_window");
        // 默认宽高
        let web_windowWidth = web_window.width;
        let web_windowHeight = web_window.height;
        // 最小宽高
        let web_windowMinWidth = web_window.minWidth;
        let web_windowMinHeight = web_window.minHeight;
        // 最大化
        let web_windowMaximizable = web_window.maximizable;
        // 是否可拖拽大小
        let web_windowResizable = web_window.resizable;
        // 是否全屏
        let web_windowFullscreenable = web_window.fullscreenable;

        // 链接中width
        let viewWindowWidth = getUrlParamValue(url, "windowWidth") || web_windowWidth;
        // 链接中height
        let viewWindowHeight = getUrlParamValue(url, "windowHeight") || web_windowHeight;
        if (viewWindowWidth && viewWindowHeight) {
            if (nowWindow) {
                nowWindow.setSize(parseInt(viewWindowWidth), parseInt(viewWindowHeight));
                // 居中
                nowWindow.center();
            }
        }

        // 链接中minWidth
        let viewWindowMinWidth = getUrlParamValue(url, "minWindowWidth") || web_windowMinWidth;
        // 链接中minHeight
        let viewWindowMinHeight = getUrlParamValue(url, "minWindowHeight") || web_windowMinHeight;
        if (viewWindowMinWidth && viewWindowMinHeight) {
            if (nowWindow) {
                nowWindow.setMinimumSize(parseInt(viewWindowMinWidth), parseInt(viewWindowMinHeight));
            }
        }

        // 链接中是否可拖拽
        let viewWindowDrag = getUrlParamValue(url, "canDragWindowSize");
        if (viewWindowDrag) {
            if (viewWindowDrag === "true") {
                web_windowResizable = true;
                web_windowMaximizable = true;
                web_windowFullscreenable = true;
            } else {
                web_windowResizable = false;
                web_windowMaximizable = false;
                web_windowFullscreenable = false;
            }
        } else {
            // 链接中resizable固定大小（弃用）
            let viewWindowFixedSize = getUrlParamValue(url, "fixedWindowSize");
            if (viewWindowFixedSize) {
                if (viewWindowFixedSize === "true") {
                    web_windowResizable = false;
                    web_windowMaximizable = false;
                    web_windowFullscreenable = false;
                } else {
                    web_windowResizable = true;
                    web_windowMaximizable = true;
                    web_windowFullscreenable = true;
                }
            }
        }
        if (nowWindow) {
            nowWindow.setResizable(web_windowResizable);
        }

        // 链接中canMaximizeWindow是否可最大化
        let viewWindowMaximizable = getUrlParamValue(url, "canMaximizeWindow");
        if (viewWindowMaximizable) {
            if (viewWindowMaximizable === "true") {
                web_windowMaximizable = true;
                web_windowFullscreenable = true;
            } else {
                web_windowMaximizable = false;
                web_windowFullscreenable = false;
            }
        }
        if (nowWindow) {
            nowWindow.setMaximizable(web_windowMaximizable);
            nowWindow.setFullScreenable(web_windowFullscreenable);
        }

        // 关闭菜单
        if (nowWindow) {
            nowWindow.removeMenu();
        }
        logger.info("[MainProcessHelper][will-navigate]新视图 " + url + " 已加载");
    });
    // 拦截重定向
    win.webContents.on("will-redirect", function (event, url, isInPlace, isMainFrame, frameProcessId, frameRoutingId) {
        // 事件拦截
        if (url.startsWith("cxkt://openUrlOnBrowser?url=")) {
            // 用默认浏览器打开地址
            let openBrowserUrl = url.replace("cxkt://openUrlOnBrowser?url=", "");
            //shell.openExternal(decodeURIComponent(openBrowserUrl));
            shell.openExternal(openBrowserUrl);
            event.preventDefault();
            return;
        }
        // 上层窗口值
        let nowWindowUUID = event.sender.browserWindowOptions.customUUID;
        let nowWindow = global.sharedWindow.windowMap.get(nowWindowUUID);
        // 默认配置项
        let web_window = config.getConfigVal("web_window");
        // 默认宽高
        let web_windowWidth = web_window.width;
        let web_windowHeight = web_window.height;
        // 最小宽高
        let web_windowMinWidth = web_window.minWidth;
        let web_windowMinHeight = web_window.minHeight;
        // 最大化
        let web_windowMaximizable = web_window.maximizable;
        // 是否可拖拽大小
        let web_windowResizable = web_window.resizable;
        // 是否全屏
        let web_windowFullscreenable = web_window.fullscreenable;

        // 链接中width
        let viewWindowWidth = getUrlParamValue(url, "windowWidth") || web_windowWidth;
        // 链接中height
        let viewWindowHeight = getUrlParamValue(url, "windowHeight") || web_windowHeight;
        if (viewWindowWidth && viewWindowHeight) {
            if (nowWindow) {
                nowWindow.setSize(parseInt(viewWindowWidth), parseInt(viewWindowHeight));
                // 居中
                nowWindow.center();
            }
        }

        // 链接中minWidth
        let viewWindowMinWidth = getUrlParamValue(url, "minWindowWidth") || web_windowMinWidth;
        // 链接中minHeight
        let viewWindowMinHeight = getUrlParamValue(url, "minWindowHeight") || web_windowMinHeight;
        if (viewWindowMinWidth && viewWindowMinHeight) {
            if (nowWindow) {
                nowWindow.setMinimumSize(parseInt(viewWindowMinWidth), parseInt(viewWindowMinHeight));
            }
        }

        // 链接中是否可拖拽
        let viewWindowDrag = getUrlParamValue(url, "canDragWindowSize");
        if (viewWindowDrag) {
            if (viewWindowDrag === "true") {
                web_windowResizable = true;
                web_windowMaximizable = true;
                web_windowFullscreenable = true;
            } else {
                web_windowResizable = false;
                web_windowMaximizable = false;
                web_windowFullscreenable = false;
            }
        } else {
            // 链接中resizable固定大小（弃用）
            let viewWindowFixedSize = getUrlParamValue(url, "fixedWindowSize");
            if (viewWindowFixedSize) {
                if (viewWindowFixedSize === "true") {
                    web_windowResizable = false;
                    web_windowMaximizable = false;
                    web_windowFullscreenable = false;
                } else {
                    web_windowResizable = true;
                    web_windowMaximizable = true;
                    web_windowFullscreenable = true;
                }
            }
        }
        if (nowWindow) {
            nowWindow.setResizable(web_windowResizable);
        }

        // 链接中canMaximizeWindow是否可最大化
        let viewWindowMaximizable = getUrlParamValue(url, "canMaximizeWindow");
        if (viewWindowMaximizable) {
            if (viewWindowMaximizable === "true") {
                web_windowMaximizable = true;
                web_windowFullscreenable = true;
            } else {
                web_windowMaximizable = false;
                web_windowFullscreenable = false;
            }
        }
        if (nowWindow) {
            nowWindow.setMaximizable(web_windowMaximizable);
            nowWindow.setFullScreenable(web_windowFullscreenable);
        }

        // 关闭菜单
        if (nowWindow) {
            nowWindow.removeMenu();
        }

        logger.info("[MainProcessHelper][will-navigate]新视图 " + url + " 已加载重定向");
    });
}

// 监控新打开地址
function win_event(win) {
    win.webContents.on("new-window", function (
        event,
        url,
        fname,
        disposition,
        options
    ) {
        // 创建浏览器窗口
        let webWindowConfig = config.getConfigVal("web_window");

        // 链接中width
        let viewWindowWidth = getUrlParamValue(url, "windowWidth");
        if (viewWindowWidth) {
            webWindowConfig.width = parseInt(viewWindowWidth);
        }
        // 链接中height
        let viewWindowHeight = getUrlParamValue(url, "windowHeight");
        if (viewWindowHeight) {
            webWindowConfig.height = parseInt(viewWindowHeight);
        }

        // 链接中minWidth
        let viewWindowMinWidth = getUrlParamValue(url, "minWindowWidth");
        if (viewWindowMinWidth) {
            webWindowConfig.minWidth = parseInt(viewWindowMinWidth);
        }
        // 链接中minHeight
        let viewWindowMinHeight = getUrlParamValue(url, "minWindowHeight");
        if (viewWindowMinHeight) {
            webWindowConfig.minHeight = parseInt(viewWindowMinHeight);
        }

        // 链接中是否可拖拽
        let viewWindowDrag = getUrlParamValue(url, "canDragWindowSize");
        if (viewWindowDrag) {
            if (viewWindowDrag === "true") {
                webWindowConfig.resizable = true;
            } else {
                webWindowConfig.resizable = false;
            }
        } else {
            // 链接中resizable固定大小（弃用）
            let viewWindowFixedSize = getUrlParamValue(url, "fixedWindowSize");
            if (viewWindowFixedSize) {
                if (viewWindowFixedSize === "true") {
                    webWindowConfig.resizable = false;
                } else {
                    webWindowConfig.resizable = true;
                }
            }
        }

        // 链接中canMaximizeWindow是否可最大化
        let viewWindowMaximizable = getUrlParamValue(url, "canMaximizeWindow");
        if (viewWindowMaximizable) {
            if (viewWindowMaximizable === "true") {
                webWindowConfig.maximizable = true;
                webWindowConfig.fullscreenable = true;
            } else {
                webWindowConfig.maximizable = false;
                webWindowConfig.fullscreenable = false;
            }
        }
        //更新标题和图标
        webWindowConfig.title = config.getConfigVal("title");
        webWindowConfig.icon = path.join(
            path.resolve(__dirname, ".."),
            config.getConfigVal("icon")
        );
        let childWindow = new BrowserWindow(webWindowConfig);
        // 添加打开事件监控
        win_event(childWindow);
        childWindow.loadURL(url);
        logger.info("[MainProcessHelper][new-window]新视图 " + url + " 已加载");
        if (config.getConfigVal("debug")) {
            // 打开开发者工具
            childWindow.webContents.openDevTools();
        }
        event.preventDefault();
    });
    // 监听跳转
    win.webContents.on("will-navigate", function (event, url) {
        let winTemp = win;
        // 链接中width
        let viewWindowWidth = getUrlParamValue(url, "windowWidth");
        // 链接中height
        let viewWindowHeight = getUrlParamValue(url, "windowHeight");
        if (viewWindowWidth && viewWindowHeight) {
            winTemp.setSize(parseInt(viewWindowWidth), parseInt(viewWindowHeight));
        }
        console.log(winTemp.getSize());
        // 链接中resizable
        let viewWindowFixedSize = getUrlParamValue(url, "fixedWindowSize");
        if (viewWindowFixedSize) {
            let viewresizable = false;
            if (viewWindowFixedSize === "true") {
                viewresizable = true;
            }
            winTemp.setResizable(!viewresizable);
        }
        logger.info("[MainProcessHelper][will-navigate]新视图 " + url + " 已加载");
    });
}

// 解析ulr上参数
function getUrlParamValue(url, param) {
    if (url && param) {
        let index = url.indexOf("?");
        if (index != -1) {
            let urlsearch = url.substr(index + 1);
            let pstr = urlsearch.split("&");
            for (let i = pstr.length - 1; i >= 0; i--) {
                let tep = pstr[i].split("=");
                if (tep[0] == param) {
                    return tep[1];
                }
            }
        }
    }
    return false;
}

// 获取全部url参数
function getUrlAllParamValues(url) {
    if (url) {
        let index = url.indexOf("?");
        if (index != -1) {
            return url.substr(index + 1);
        }
    }
    return false;
}

/**
 * 获取传递给当前窗口的参数
 * @kind MainProcessOnly [仅能主进程调用]
 * @return any 路由变量
 */
function getRouterArgs() {
    return global.sharedObject.args.default; //返回全局
}

const ipcMain = require("electron").ipcMain; //ipcMain进程对象

//ipcMain收到router信号
ipcMain.on("router", function (sys, view) {
    logger.info(
        "[MainProcessHelper][_router_]主进程main.js收到跳转指令信号 目标视图 " +
        view
    );
    openNewWindow(view);
});

/**
 * 注册主进程收到特定信号的回调函数
 * @kind MainProcessOnly [仅主进程]
 * @param {string} signal 收到的信号量
 * @param {function} callback 回调函数
 */
function registeCallback(signal, callback) {
    if (typeof callback === "function") {
        ipcMain.on(signal, (sys, args) => {
            callback(args, sys);
        });
    }
}

/**
 *投屏相关-会议页面打开工具栏
 * cmd 指令
 * useLocalTools 是否使用本地1或0
 * leader  1 创建者  0 观众（学生）2助教
 * language 语言language中文,1英文
 * curScreenValue 当前屏幕共享分辨率720p_1,1080p_1
 * hasAudioDev 语音设备true或false
 * hasVideoDev 视频设备true或false
 * audioSetStatus 语音状态1或0
 * videoSetStatus 视频状态1或0
 * recordSetStatus 录制状态1或0
 * isPublic 课堂是否开放1或0
 * meetTime 会议开始时间
 * membersNumber 成员数量
 * chatNumber 未读消息数
 * shareWindowWidth 会议屏幕共享后宽
 * shareWindowHeight 会议屏幕共享后高
 * width 会议屏幕共享后工具栏宽-即屏幕宽
 * height 会议屏幕共享后工具栏高-即屏幕高
 */
//ipcMain收到screenTools信号
ipcMain.on("screenTools", function (sys, message) {
    if (!message || !message.cmd) {
        return;
    }
    if (config.getConfigVal("debug")) {
        logger.debug("[MainProcessHelper][_screenTools_]主进程main.js收到投屏指令信号 指令 " + JSON.stringify(message));
    }
    message.debug = config.getConfigVal("debug");
    message.meet_debug = config.getConfigVal("meet_debug");
    if ("startScreen" == message.cmd) {
        // 打开选择窗口
        let choseWindowTemp = global.sharedWindow.windowMap.get(choseScreenWindowUUID);
        if (choseWindowTemp) {
            //将screenToolsWindow置为null
            global.sharedWindow.windowMap.delete(choseScreenWindowUUID);
            choseWindowTemp.close();
        }
        let screenToolsWindow = global.sharedWindow.windowMap.get(screenToolsWindowUUID);
        if (!screenToolsWindow) {
            // 获取窗口集合中
            let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
            if (!meetWindowTemp) {
                return;
            }
            //是否使用本地工具栏1或0
            let useLocalTools = message.useLocalTools || 1;
            if (useLocalTools == 1) {
                useLocalTools = true;
            } else {
                useLocalTools = false;
            }
            //会议屏幕共享后工具栏宽-即屏幕宽
            let winWidthTemp = message.width;
            if (winWidthTemp) {
                winWidthTemp = parseInt(winWidthTemp);
            } else {
                winWidthTemp = 800;
            }
            //会议屏幕共享后工具栏高-即屏幕高
            let winHeightTemp = message.height;
            if (winHeightTemp) {
                winHeightTemp = parseInt(winHeightTemp);
            } else {
                winHeightTemp = 600;
            }
            //会议屏幕共享后宽
            let meetWinWidthTemp = message.shareWindowWidth;
            if (meetWinWidthTemp) {
                meetWinWidthTemp = parseInt(meetWinWidthTemp);
            } else {
                meetWinWidthTemp = 300;
            }
            //会议屏幕共享后高
            let meetWinHeightTemp = message.shareWindowHeight;
            if (meetWinHeightTemp) {
                meetWinHeightTemp = parseInt(meetWinHeightTemp);
            } else {
                meetWinHeightTemp = 640;
            }
            // 获取窗口原参数
            let meetWindowOptionsTemp = meetWindowTemp.webContents.browserWindowOptions;
            // 退出全屏
            meetWindowTemp.setFullScreen(false);
            // 更新会议窗口信息
            meetWindowTemp.setMinimumSize(meetWinWidthTemp, meetWinHeightTemp);
            meetWindowTemp.setSize(meetWinWidthTemp, meetWinHeightTemp);
            meetWindowTemp.setContentSize(meetWinWidthTemp, meetWinHeightTemp);
            if (process.platform === 'darwin') {
                // 不显示红绿灯
                //meetWindowTemp.setWindowButtonVisibility(false);
            }
            meetWindowTemp.setResizable(false);
            // 计算窗口位置
            let {width: screenWidth, height: screenHeight} = electron.screen.getPrimaryDisplay().workAreaSize;
            let moveX = screenWidth - (screenWidth * 0.3);
            let moveY = screenHeight * 0.1;
            // let moveX = winWidthTemp - (winWidthTemp * 0.3);
            // let moveY = winHeightTemp * 0.1;
            // 必须转int否则mac报错
            moveX = parseInt(moveX);
            moveY = parseInt(moveY);
            meetWindowTemp.setPosition(moveX, moveY, false);
            // 再次更新窗口大小临时修复页面问题
            /*meetWindowTemp.setMinimumSize(meetWinWidthTemp, meetWinHeightTemp);
            meetWindowTemp.setSize(meetWinWidthTemp, meetWinHeightTemp);
            meetWindowTemp.setContentSize(meetWinWidthTemp, meetWinHeightTemp);*/
            meetWindowTemp.show();
            // 传递参数
            let queryValues = "?_t=0";
            //语言language中文,1英文
            let language = message.language || "language";
            queryValues += "&language=" + language;
            // 当前邀请码
            let qrcode = message.qrcode || "";
            // 当前邀请码二维码
            let qrcodeUrl = message.qrcodeUrl || "";
            // 当前邀请码二维码提示语句
            let qrcodeTips = message.qrcodeTips || "";
            //当前视屏分辨率是否可切换
            let videoValueChange = message.videoValueChange || "";
            queryValues += "&videoValueChange=" + videoValueChange;
            //当前视屏共享分辨率180p_1,720p_1
            let curVideoValue = message.curVideoValue || "180p_1";
            queryValues += "&curVideoValue=" + curVideoValue;
            //当前屏幕分辨率是否可切换
            let screenValueChange = message.screenValueChange || "";
            queryValues += "&screenValueChange=" + screenValueChange;
            //当前屏幕共享分辨率720p_1,1080p_1
            let curScreenValue = message.curScreenValue || "720p_1";
            queryValues += "&curScreenValue=" + curScreenValue;
            //身份1-创建者,0-观众（学生）,2-助教
            let leader = message.leader || "0";
            queryValues += "&leader=" + leader;
            //语音设备true或false
            let hasAudioDev = message.hasAudioDev || "false";
            queryValues += "&hasAudioDev=" + hasAudioDev;
            //视频设备true或false
            let hasVideoDev = message.hasVideoDev || "false";
            queryValues += "&hasVideoDev=" + hasVideoDev;
            //语音状态1或0
            let audioSetStatus = message.audioSetStatus || "0";
            queryValues += "&audioSetStatus=" + audioSetStatus;
            //视频状态1或0
            let videoSetStatus = message.videoSetStatus || "0";
            queryValues += "&videoSetStatus=" + videoSetStatus;
            //录制状态1或0
            let recordSetStatus = message.recordSetStatus || "0";
            queryValues += "&recordSetStatus=" + recordSetStatus;
            //课堂是否开放1或0
            let isPublic = message.isPublic || "1";
            queryValues += "&isPublic=" + isPublic;
            // 设置- 允许主动退出课堂
            let isAllowToLeave = message.isAllowToLeave || "1";
            queryValues += "&isAllowToLeave=" + isAllowToLeave;
            // 设置-全体静音后，允许自我解除静音
            let isAllowUnmuteSelf = message.isAllowUnmuteSelf || "1";
            queryValues += "&isAllowUnmuteSelf=" + isAllowUnmuteSelf;
            // 设置-锁定课堂
            let isLockMeet = message.isLockMeet || "0";
            queryValues += "&isLockMeet=" + isLockMeet;
            //会议开始时间
            let meetTime = message.meetTime || new Date().getTime();
            queryValues += "&meetTime=" + meetTime;
            //成员数量
            let membersNumber = message.membersNumber || "0";
            queryValues += "&membersNumber=" + membersNumber;
            //未读消息数
            let chatNumber = message.chatNumber || "0";
            queryValues += "&chatNumber=" + chatNumber;
            
            // 投屏相关参数
            let screenType = message.type || "1";
            let screenInfo = message.info || "";
            
            // 窗口工具的坐标
            let screenToolsX = 0;
            let screenToolsY = 0;
            if (screenType == "1") {
                if (screenInfo && screenInfo.displayId) {
                    // 是否是mac
                    if (process.platform === 'darwin') {
                        let screenInfoTemp = activeWinHelper.getScreenByIdSync(screenInfo.displayId.id);
                        if (screenInfoTemp) {
                            screenToolsX = screenInfoTemp.x;
                            screenToolsY = screenInfoTemp.y;
                        }
                    } else {
                        screenToolsX = screenInfo.displayId.x;
                        screenToolsY = screenInfo.displayId.y;
                    }
                }
            } else if (screenType == "2") {
                if (screenInfo && screenInfo.windowId) {
                    try {
                        let windowInfoTemp = activeWinHelper.getByHidSync(screenInfo.windowId);
                        if (windowInfoTemp) {
                            let windowXTemp = windowInfoTemp.bounds.x || 0;
                            if (windowInfoTemp.screens && windowInfoTemp.screens.length > 0) {
                                // 处理多屏幕
                                for (let i = 0; i < windowInfoTemp.screens.length; i++) {
                                    let screensInfoTemp = windowInfoTemp.screens[i];
                                    if (windowXTemp >= screensInfoTemp.x && windowXTemp < (screensInfoTemp.x + screensInfoTemp.width)) {
                                        screenToolsX = screensInfoTemp.x;
                                        screenToolsY = screensInfoTemp.y;
                                        winWidthTemp = screensInfoTemp.width;
                                        winHeightTemp = screensInfoTemp.height;
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        console.error(e);
                    }
                }
            }
            // 创建窗口
            screenToolsWindow = new BrowserWindow({
                "width": winWidthTemp,
                "height": winHeightTemp,
                "x": screenToolsX,
                "y": screenToolsY,
                "webPreferences": {
                    "nodeIntegration": true,
                    "enableRemoteModule": true
                },
                "frame": false,
                "center": true,
                "movable": false,
                "hasShadow": false,
                "resizable": false,
                "alwaysOnTop": true,
                "skipTaskbar": true,
                "transparent": true,
                "autoHideMenuBar": true,
                "enableLargerThanScreen": true,
            });
            // 引入主入口界面
            if (useLocalTools) {
                // 引用本地比较快
                screenToolsWindow.loadFile(path.join(path.resolve(__dirname, ".."), "/view/box.html"), {"search": queryValues});
            } else {
                // 引用在线便于更新
                screenToolsWindow.loadURL(config.getUrlPathConfigVal("menu_box_url") + queryValues);
            }
            // win直接全屏,macos直接简单全屏
            if (process.platform === 'darwin') {
                //screenToolsWindow.setSize(winWidthTemp, winHeightTemp);
                //screenToolsWindow.setContentSize(winWidthTemp, winHeightTemp);
                //screenToolsWindow.setSimpleFullScreen(true);
                //screenToolsWindow.maximize();
                screenToolsWindow.setAlwaysOnTop(true, 'screen-saver') // mac
                screenToolsWindow.setVisibleOnAllWorkspaces(true) // mac
            } else {
                //screenToolsWindow.setSize(winWidthTemp, winHeightTemp);
                //screenToolsWindow.setContentSize(winWidthTemp, winHeightTemp);
                screenToolsWindow.setFullScreen(true);
            }
            if (config.getConfigVal("meet_debug") || config.getConfigVal("debug")) {
                // 打开开发者工具
                screenToolsWindow.webContents.openDevTools();
                screenToolsWindow.setFullScreen(false);
                winWidthTemp = 800;
                winHeightTemp = 600;
                screenToolsWindow.setSize(winWidthTemp, winHeightTemp);
                screenToolsWindow.setContentSize(winWidthTemp, winHeightTemp);
                // 会议居中
                meetWindowTemp.center();
            }
            // 需要加上转发不然会失效
            screenToolsWindow.setIgnoreMouseEvents(true, {forward: true});
            // 失去焦点处理-针对mac 测试后效果不理想
            /*screenToolsWindow.on('blur', function () {
                screenToolsWindow.setIgnoreMouseEvents(true, {forward: true});
            });*/
            // 当窗口关闭前触发
            screenToolsWindow.on("close", function (e) {
                // 先判断是否存在对象
                e.sender.webContents.executeJavaScript("typeof beforeWindowClose").then((result) => {
                    if (result !== "undefined") {
                        // 存在执行此方法获取返回值
                        e.sender.webContents.executeJavaScript("beforeWindowClose()").then((result) => {
                            if (result !== "1") {
                                //将screenToolsWindow置为null
		                        global.sharedWindow.windowMap.delete(screenToolsWindowUUID);
                                e.sender.destroy();
                            }
                        });
                    } else {
                        // 不存在直接销毁
                        //将screenToolsWindow置为null
                        global.sharedWindow.windowMap.delete(screenToolsWindowUUID);
                        e.sender.destroy();
                    }
                })
                e.preventDefault();
            });
            // 组装发送参数
            let finishLoadSendValue = {
                "cmd": "dataInfo",
                "qrcode": qrcode,
                "qrcodeUrl": qrcodeUrl,
                "qrcodeTips": qrcodeTips,
                "screenType": screenType,
                "screenInfo": screenInfo,
                "screenToolsX": screenToolsX,
                "screenToolsY": screenToolsY
            };
            // 当窗口加载完毕后-发送邀请码信息
            screenToolsWindow.webContents.on("did-stop-loading", () => {
                screenToolsWindow.webContents.send(meetToolsMessageFormMainChannel, finishLoadSendValue);
            });
            // 放入窗口集合中
            global.sharedWindow.windowMap.set(screenToolsWindowUUID, screenToolsWindow);
        }
    } else if ("stopScreen" == message.cmd) {
        let screenToolsWindow = global.sharedWindow.windowMap.get(screenToolsWindowUUID);
        if (screenToolsWindow) {
            // 获取窗口集合中
            let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
            if (meetWindowTemp) {
                // 改变大小前先居中，避免多屏幕位置跑偏
                meetWindowTemp.center();
                // 获取窗口原参数
                let meetWindowOptionsTemp = meetWindowTemp.webContents.browserWindowOptions;
                // 更新会议窗口信息
                meetWindowTemp.setMinimumSize(meetWindowOptionsTemp.minWidth, meetWindowOptionsTemp.minHeight);
                meetWindowTemp.setSize(meetWindowOptionsTemp.width, meetWindowOptionsTemp.height);
                meetWindowTemp.setContentSize(meetWindowOptionsTemp.width, meetWindowOptionsTemp.height);
                if (process.platform === 'darwin') {
                    // 不显示红绿灯
                    //meetWindowTemp.setWindowButtonVisibility(false);
                }
                meetWindowTemp.setResizable(true);
                meetWindowTemp.center();
                meetWindowTemp.show();
            }
            //将screenToolsWindow置为null
            global.sharedWindow.windowMap.delete(screenToolsWindowUUID);
            // 销毁窗口
            screenToolsWindow.destroy();
        }
    } else if ("changeMeetWindowSize" == message.cmd) {
        let windowWidthTemp = message.windowWidth;
        let windowHeightTemp = message.windowHeight;
        if (!windowWidthTemp || !windowHeightTemp) {
            return;
        }
        // 获取窗口集合中
        let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
        if (meetWindowTemp) {
            // 更新会议窗口信息
            meetWindowTemp.setMinimumSize(windowWidthTemp, windowHeightTemp);
            meetWindowTemp.setSize(windowWidthTemp, windowHeightTemp);
            meetWindowTemp.setContentSize(windowWidthTemp, windowHeightTemp);
            meetWindowTemp.setResizable(false);
            meetWindowTemp.show();
        }
    } else if ("choseScreen" == message.cmd) {
        // 当前桌面
        let displays = message.displays || "";
        // 当前窗口
        let winplays = message.winplays || "";
        // 传递参数
        let queryValues = "?_t=0";
        //语言language中文,1英文
        let language = message.language || "language";
        queryValues += "&language=" + language;
        // 打开选择窗口
        let choseWindowTemp = global.sharedWindow.windowMap.get(choseScreenWindowUUID);
        if (!choseWindowTemp) {
            let windowOptionsTemp = {
                "width": 1100,
                "height": 750,
                "webPreferences": {
                    "nodeIntegration": true,
                    "enableRemoteModule": true
                },
                "frame": false,
                "center": true,
                "autoHideMenuBar": true,
                "maximizable": false,
                "minimizable": false,
                "resizable": false,
                "fullscreenable": false,
            };
            // 父子窗口
            let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
            if (meetWindowTemp) {
                windowOptionsTemp.parent = meetWindowTemp;
            }
            // 创建窗口
            choseWindowTemp = new BrowserWindow(windowOptionsTemp);
            // 引用本地比较快
            choseWindowTemp.loadFile(path.join(path.resolve(__dirname, ".."), "/view/choseScreen.html"), {"search": queryValues});

            if (config.getConfigVal("debug")) {
                // 打开开发者工具
                choseWindowTemp.webContents.openDevTools();
            }
            if (config.getConfigVal("meet_debug")) {
                // 打开开发者工具
                choseWindowTemp.webContents.openDevTools();
            }
            // 所有窗口句柄
            let windowIds = new Array();
            // 当前窗口
            let hwndTemp = choseWindowTemp.getNativeWindowHandle();
            windowIds.push(hwndTemp.readUInt32LE(0));
            if (global.sharedWindow.windowMap.size > 0) {
                // 循环判断窗口
                global.sharedWindow.windowMap.forEach(function (value, key) {
                    hwndTemp = value.getNativeWindowHandle();
                    windowIds.push(hwndTemp.readUInt32LE(0));
                    //TODO mac暂时不能直接取到
                });
            }
            // 组装发送参数
            let finishLoadSendValue = {
                "cmd": "choseData",
                "language": language,
                "displays": displays,
                "winplays": winplays,
                "windowIds": windowIds,
            };
            // 当窗口加载完毕后-发送邀请码信息
            choseWindowTemp.webContents.on("did-stop-loading", () => {
                choseWindowTemp.webContents.send(meetChosesMessageFormMainChannel, finishLoadSendValue);
            });
	        // 当窗口关闭前触发
	        choseWindowTemp.on("close", function (e) {
		        //将choseScreenWindow置为null
		        global.sharedWindow.windowMap.delete(choseScreenWindowUUID);
		        e.sender.destroy();
	        });
            // 放入窗口集合中
            global.sharedWindow.windowMap.set(choseScreenWindowUUID, choseWindowTemp);
        }
    } else if ("choseScreenData" == message.cmd) {
        // 发送可选择窗口数据
        let choseWindowTemp = global.sharedWindow.windowMap.get(choseScreenWindowUUID);
        if (choseWindowTemp) {
            if (global.sharedWindow.windowMap.size > 0) {
                // 所有窗口句柄
                let windowIds = new Array();
                // 循环判断窗口
                global.sharedWindow.windowMap.forEach(function (value, key) {
                    let hwndTemp = value.getNativeWindowHandle();
                    windowIds.push(hwndTemp.readUInt32LE(0));
                });
                message.windowIds = windowIds;
            }
            choseWindowTemp.webContents.send(meetChosesMessageFormMainChannel, message);
        }
    } else if ("openVideoBox" == message.cmd) {
        if (typeof message.uid == "undefined") {
            return;
        }
        // 更新下数据
        message.cmd = "videoData";
        let widthTemp = message.width || 320;
        if (widthTemp) {
            widthTemp = parseInt(widthTemp);
        }
        let heightTemp = message.height || 200;
        if (heightTemp) {
            heightTemp = parseInt(heightTemp) + 30;
        }
        // 打开选择窗口
        let openVideoBoxWindowTemp = global.sharedWindow.windowMap.get(openVideoBoxWindowUUID);
        if (!openVideoBoxWindowTemp) {
            if (!message.init) {
                return;
            }
            // 创建窗口
            openVideoBoxWindowTemp = new BrowserWindow({
                "width": widthTemp,
                "height": heightTemp,
                "webPreferences": {
                    "nodeIntegration": true,
                    "enableRemoteModule": true
                },
                "frame": false,
                "center": true,
                "maximizable": true,
                "minimizable": true,
                "resizable": true,
                "transparent": true,
                "autoHideMenuBar": true,
            });
            // 引用本地比较快
            openVideoBoxWindowTemp.loadFile(path.join(path.resolve(__dirname, ".."), "/view/videoBox.html"));

            if (config.getConfigVal("debug")) {
                // 打开开发者工具
                openVideoBoxWindowTemp.webContents.openDevTools();
            }
            if (config.getConfigVal("meet_debug")) {
                // 打开开发者工具
                openVideoBoxWindowTemp.webContents.openDevTools();
            }
            // 当窗口加载完毕后-发送信息
            openVideoBoxWindowTemp.webContents.on("did-stop-loading", () => {
                openVideoBoxWindowTemp.webContents.send(meetVideoMessageFormMainChannel, message);
            });
            // 当窗口关闭前触发
            openVideoBoxWindowTemp.on("close", function (e) {
                e.sender.destroy();
            });
            // 当窗口关闭时触发
            openVideoBoxWindowTemp.on("closed", function () {
                if (mainWindow != null) {
                    if (global.sharedWindow.windowMap.size == 2) {
                        //显示父窗口
                        mainWindow.show();
                    }
                }
                //将choseScreenWindow置为null
                global.sharedWindow.windowMap.delete(openVideoBoxWindowUUID);
            });
            // 放入窗口集合中
            global.sharedWindow.windowMap.set(openVideoBoxWindowUUID, openVideoBoxWindowTemp);
        } else {
            // 初始化更新窗口大小
            if (message.init) {
                openVideoBoxWindowTemp.center();
                openVideoBoxWindowTemp.setMinimumSize(widthTemp, heightTemp);
                openVideoBoxWindowTemp.setSize(widthTemp, heightTemp);
                openVideoBoxWindowTemp.setContentSize(widthTemp, heightTemp);
                openVideoBoxWindowTemp.show();
            }
            openVideoBoxWindowTemp.webContents.send(meetVideoMessageFormMainChannel, message);
        }
    } else {
        // 直接转发到工具栏页面,由页面处理
        // 获取窗口集合中
        let screenToolsWindowTemp = global.sharedWindow.windowMap.get(screenToolsWindowUUID);
        if (!screenToolsWindowTemp) {
            return;
        }
        // 直接转发,由页面处理
        try {
            screenToolsWindowTemp.webContents.send(meetToolsMessageFormMainChannel, message);
        } catch (e) {
            console.error(e);
        }
    }
});

/**
 *顶部投屏工具栏相关-工具栏发送消息到会议
 */
//ipcMain收到meetTools信号
ipcMain.on("meetTools", function (sys, message) {
    if (!message || !message.cmd) {
        return;
    }
    // 获取窗口集合中
    let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
    if (!meetWindowTemp) {
        return;
    }
    if (config.getConfigVal("debug")) {
        logger.debug("[MainProcessHelper][_meetTools_]主进程main.js收到投屏指令信号 指令 " + JSON.stringify(message));
    }
    message.debug = config.getConfigVal("debug");
    message.meet_debug = config.getConfigVal("meet_debug");
    // 直接转发,由页面处理
    meetWindowTemp.webContents.send(meetToolsFormMainChannel, message);
});

/**
 *选择投屏窗口相关-选择投屏窗口发送消息到会议
 */
//ipcMain收到meetChoses信号
ipcMain.on("meetChoses", function (sys, message) {
    if (!message || !message.cmd) {
        return;
    }
    // 获取窗口集合中
    let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
    if (!meetWindowTemp) {
        return;
    }
    if (config.getConfigVal("debug")) {
        logger.debug("[MainProcessHelper][_meetChoses_]主进程main.js收到投屏指令信号 指令 " + JSON.stringify(message));
    }
    message.debug = config.getConfigVal("debug");
    message.meet_debug = config.getConfigVal("meet_debug");
    // 直接转发,由页面处理
    meetWindowTemp.webContents.send(meetToolsFormMainChannel, message);
});

/**
 *视屏窗口相关-视屏窗口发送消息到会议
 */
//ipcMain收到meetChoses信号
ipcMain.on("meetVideo", function (sys, message) {
    if (!message || !message.cmd) {
        return;
    }
    // 获取窗口集合中
    let meetWindowTemp = global.sharedWindow.windowMap.get(meetWindowUUID);
    if (!meetWindowTemp) {
        // 主窗口不存在关闭视屏窗口
        let openVideoBoxWindowTemp = global.sharedWindow.windowMap.get(openVideoBoxWindowUUID);
        if (openVideoBoxWindowTemp) {
            openVideoBoxWindowTemp.close();
        }
        return;
    }
    if (config.getConfigVal("debug")) {
        logger.debug("[MainProcessHelper][_meetVideo_]主进程main.js收到投屏指令信号 指令 " + JSON.stringify(message));
    }
    message.debug = config.getConfigVal("debug");
    message.meet_debug = config.getConfigVal("meet_debug");
    // 直接转发,由页面处理
    meetWindowTemp.webContents.send(meetToolsFormMainChannel, message);
});

module.exports = {createMainWindow, getMainWindow, openNewWindow};
